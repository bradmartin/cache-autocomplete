!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cacheautocomplete",[],t):"object"==typeof exports?exports.cacheautocomplete=t():e.cacheautocomplete=t()}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function o(e){f=e.rootElement,p=document.createElement("ul"),C=e.cache,m=e.onItemSelect,f.addEventListener("keydown",function(e){9===e.keyCode&&h.length>0&&(e.preventDefault(),p.childNodes[0].focus()),40===e.keyCode&&h.length>0&&(e.preventDefault(),p.childNodes[0].focus())}),f.addEventListener("keyup",function(t){var n=t.target;return""===n.value?(c(),void s()):void(n.value.trim().length>=e.minStringLength&&(g=e.queryUrl.replace(e.wildCard,f.value),a(g,!1).then(function(t){c(),"string"==typeof t&&(t=JSON.parse(t)),l(t,e.itemValue,e.listClass,e.itemClass),document.addEventListener("click",i)},function(t){c(),l([{key:"No Matches"}],"key",e.listClass,e.itemClass,!0),document.addEventListener("click",i)})))})}function r(e){if(e)localStorage.removeItem("CAC-"+e);else for(var t=localStorage.length;t--;){var n=localStorage.key(t);0===n.lastIndexOf("CAC",0)&&localStorage.removeItem(n)}}function i(e){console.log(e),h.length>0&&(c(),s())}function a(e,t){return void 0===t&&(t=!1),new Promise(function(n,o){for(var r=!1,i=localStorage.length;i--;){var a=localStorage.key(i);if(0===a.lastIndexOf("CAC",0)){var l=a.indexOf(e)>-1;l===!0&&(r=!0)}if(r===!0)break}if(r&&t)d(e).then(function(t){C&&u(e,t),n(t)},function(e){o(e)});else if(r&&!t){var c=localStorage.getItem("CAC-"+e);n(JSON.parse(c))}else r?o("get outta here"):d(e).then(function(t){C&&u(e,t),n(t)},function(e){o(e)})})}function l(e,t,n,o,r){void 0===r&&(r=!1);for(var i=function(n){var i=document.createElement("li");i.id=e.indexOf(e[n]).toString(),i.tabIndex=0,i.innerHTML=""+e[n][t],i.classList.add(o),r||(i.addEventListener("keydown",function(n){var o=n.target;if(13===n.keyCode){var r=e[parseInt(o.id,10)];f.value=r[t],s(),m(r)}if(40===n.keyCode&&h.length>0){n.preventDefault();var a=i.nextSibling;a?"li"===a.nodeName.toLowerCase()&&a.focus():p.childNodes[0].focus()}if(38===n.keyCode&&h.length>0){n.preventDefault();var l=i.previousSibling;l?"li"===l.nodeName.toLowerCase()&&l.focus():f.focus()}}),i.addEventListener("click",function(n){var o=n.target;if(o&&"li"===o.nodeName.toLowerCase()){var r=e[parseInt(o.id,10)];f.value=r[t],c(),s(),m&&m(r)}})),h.push(i),p.appendChild(i)},a=0;a<e.length;a++)i(a);Object.assign(p.style,{listStyle:"none",padding:"0",margin:"0"}),v||(v=document.createElement("div")),v.classList.add(n),Object.assign(v.style,{position:"absolute",zIndex:"999999999",overflowY:"auto",maxHeight:"300px",width:f.clientWidth.toString()+"px"}),v.appendChild(p),f.parentNode.insertBefore(v,f.nextSibling),p.focus()}function c(){if(p.getElementsByTagName("li").length>0){for(;p.firstChild;)p.removeChild(p.firstChild);h=[]}}function s(){v&&v.parentNode&&v.parentNode.removeChild(v),document.removeEventListener("click",i)}function u(e,t){localStorage&&localStorage.setItem("CAC-"+e,JSON.stringify(t))}function d(e,t){return void 0===t&&(t="GET"),new Promise(function(n,o){var r=new XMLHttpRequest;r.open(t,e,!0),r.onload=function(){r.status>=200&&r.status<300?n(r.response):o(r.statusText)},r.onerror=function(){o(r.statusText)},r.send()})}var f,v,p,g,m,h=[],C=!0;t.create=o,t.clearCache=r}])});
//# sourceMappingURL=cacheautocomplete.js.map